# A Signature-Based NIDS with Tamper-Evident Logging

**Course:** CYBS 4473/5473: Network Security, Fall 2025  
**Team:** Alexander Lee, Josiah Rhodes, Connor Tunnell  

---

## 1. Project Objective

This project is the design and implementation of a signature-based Network Intrusion Detection System (NIDS). The system analyzes network traffic in real time for malicious patterns and securely logs all alerts using a **hash-chain** for integrity and **RSA digital signatures** for authenticity.

The system features a live web dashboard for monitoring traffic and alerts, and a separate verification script to prove the log file has not been tampered with.

---

## 2. Features

- **Real-time Packet Sniffing:** Uses the `scapy` library to capture and analyze packets from a specified network interface.  
- **Live Web Dashboard:** A Flask and Socket.IO-based web UI that provides a real-time graph of packet counts and a live feed of all security alerts.  
- **Intrusion Detection Engine:**
  - **Port Scan Detection:** Identifies common TCP stealth scans (NULL, FIN, XMAS) and SYN-based scans.  
  - **Signature Detection:** Matches packet payloads against a list of known malicious signatures (e.g., reverse shell commands).  
- **Secure & Tamper-Evident Logging:**
  - **Integrity (Hash-Chain):** Each new log entry contains a SHA-256 hash of the previous entry, creating a verifiable chain.  
  - **Authenticity (Digital Signatures):** Each log entry is signed with a private RSA key. A separate public key can be used to verify that the logs were generated by this NIDS and not an impostor.

---

## 3. Technology Stack

**Backend:**
- Python 3
  - `scapy`: Packet sniffing and analysis  
  - `cryptography`: RSA key generation, signing, and verification  
  - `flask` & `flask-socketio`: Web server and real-time WebSocket communication  

**Frontend:**
- HTML, CSS, JavaScript  
  - `socket.io.js`: Receives live data from the server  
  - `Chart.js`: Renders the live traffic graph  

**Environment & Tools:**
- GitHub Codespaces  
- `nmap` & `ncat`: Used for generating test attack traffic  

---

## 4. File Structure
```text
├── .devcontainer/
│   └── devcontainer.json  # Config for Codespaces
├── templates/
│   └── index.html         # Frontend web dashboard
├── generate_keys.py       # (Run once) Creates RSA key pair
├── nids.py                # Main application (Sniffer + Web Server)
├── secure_logger.py       # Class for secure logging
├── verify_log.py          # Script to check log integrity
├── requirements.txt       # Python dependencies
├── nids.log               # (Generated) Secure log output
├── private_key.pem        # (Generated) Private RSA key
└── public_key.pem         # (Generated) Public RSA key
```

---

## 5. Setup & Installation (Codespaces)

This project is pre-configured for GitHub Codespaces.

1. Open this repository in a GitHub Codespace.  
2. The container will automatically build, installing all system dependencies (like `libpcap-dev`) and Python libraries from `requirements.txt`.  
3. Once the build is complete, generate the cryptographic keys:
   ```bash
   python3 generate_keys.py


6. How to Run the NIDS

Start the NIDS:
--Run the main script with sudo -E to grant it packet-sniffing permissions while inheriting your Python environment.
```bash
sudo -E python3 nids.py
```

Access the Dashboard:

-- The terminal will show the server is running on port 5000.

-- Go to the "PORTS" tab in your VS Code sidebar.

-- Find Port 5000, right-click it, and select "Open in Browser".

-- A new browser tab will open with the live dashboard.
